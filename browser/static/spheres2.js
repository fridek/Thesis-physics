function m(b,a,c){return b.call.apply(b.bind,arguments)}function p(b,a,c){if(!b)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return b.apply(a,c)}}return function(){return b.apply(a,arguments)}}function q(b,a,c){q=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?m:p;return q.apply(null,arguments)};var r=Array.prototype,s=r.indexOf?function(b,a,c){return r.indexOf.call(b,a,c)}:function(b,a,c){c=null==c?0:0>c?Math.max(0,b.length+c):c;if("string"==typeof b)return"string"==typeof a&&1==a.length?b.indexOf(a,c):-1;for(;c<b.length;c++)if(c in b&&b[c]===a)return c;return-1};function t(b,a,c,d,e,f,g){this.s=g;this.childNodes=[];this.left=b;this.right=a;this.top=c;this.bottom=d;this.g=e;this.i=f;this.a=[]}
t.prototype.split=function(){var b=(this.left+this.right)/2,a=(this.top+this.bottom)/2,c=(this.g+this.i)/2,d=this.s-1;this.childNodes[0]=new t(this.left,b,this.top,a,this.g,c,d);this.childNodes[1]=new t(b,this.right,this.top,a,this.g,c,d);this.childNodes[2]=new t(this.left,b,a,this.bottom,this.g,c,d);this.childNodes[3]=new t(b,this.right,a,this.bottom,this.g,c,d);this.childNodes[4]=new t(this.left,b,this.top,a,c,this.i,d);this.childNodes[5]=new t(b,this.right,this.top,a,c,this.i,d);this.childNodes[6]=
new t(this.left,b,a,this.bottom,c,this.i,d);this.childNodes[7]=new t(b,this.right,a,this.bottom,c,this.i,d)};function w(b){return 0<b.a.length||b.childNodes.some(function(a){return w(a)})}
function x(b,a,c,d,e,f,g){var h=(b.left+b.right)/2,l=(b.top+b.bottom)/2,n=(b.g+b.i)/2,k=0,u=b=!1,v=!1;a<h&&c<h?k+=0:a>h&&c>h?k+=1:b=!0;d<l&&e<l?k+=0:d>l&&e>l?k+=2:u=!0;f<n&&g<n?k+=0:f>n&&g>n?k+=4:v=!0;a=[k];if(v)for(c=0,d=a.length;c<d;c++)a.push(a[c]+4);if(u)for(c=0,d=a.length;c<d;c++)a.push(a[c]+2);if(b)for(c=0,d=a.length;c<d;c++)a.push(a[c]+1);return a}
function y(b,a){if(-1==b.a.indexOf(a)){var c=a.d-a.c,d=a.d+a.c,e=a.b-a.c,f=a.b+a.c,g=a.e-a.c,h=a.e+a.c;0==b.s||0==b.a.length?b.a.push(a):(0==b.childNodes.length&&b.split(),x(b,c,d,e,f,g,h).forEach(function(b){y(this.childNodes[b],a)},b))}};function z(){this.j=this.velocityY=this.velocityX=this.e=this.b=this.d=0.1;this.c=5.5}z.prototype.step=function(b){this.d+=this.velocityX*b;this.b+=this.velocityY*b;this.e+=this.j*b};function A(){this.f=Array(1E3);for(var b=0;1E3>b;b++){var a=new z;a.d=400*(Math.random()-0.5);a.b=200*(Math.random()-0.5);a.e=100*(Math.random()-0.5);a.velocityX=1*(Math.random()-0.5);a.velocityY=1*(Math.random()-0.5);a.j=1*(Math.random()-0.5);this.f[b]=a}this.l=new THREE.G(20,3,1,1E4);this.l.position.z=1E3;(new THREE.F(this.l)).addEventListener("change",q(function(){this.m.t(this.h,this.l)},this));this.h=new THREE.J;b=new THREE.I(16777215);b.position.set(-40,60,-10);this.h.add(b);b=new THREE.v(20);
this.h.add(b);var b=new THREE.H(1E4,1E4,100,100),c=new THREE.C({color:13421772,Q:!0}),b=new THREE.p(b,c);b.rotation.x=-0.5*Math.PI;b.position.x=0;b.position.y=-100;b.position.z=0;this.h.add(b);c=new THREE.D({color:16711680});this.o=Array(1E3);for(b=0;1E3>b;b++)a=new THREE.K(this.f[b].c,10,10),a=new THREE.p(a,c),a.position.x=this.f[b].d,a.position.y=this.f[b].b,a.position.z=this.f[b].e,this.o[b]=a,this.h.add(a);this.m=new THREE.L;this.m.P(1200,400);document.body.appendChild(this.m.N);this.m.t(this.h,
this.l);this.q=this.r=0;this.k=new t(-1E3,1E3,-1E3,1E3,-1E3,1E3,5);for(b=0;1E3>b;b++)y(this.k,this.f[b]);this.u=[]}function B(b,a){if(!a.n){var c=a.right-a.left,d=a.bottom-a.top,e=a.i-a.g,f=new THREE.A(c,d,e);f.M((new THREE.B).O(a.left+c/2,a.top+d/2,a.g+e/2));a.n=new THREE.w(new THREE.p(f));b.u.push(a.n);b.h.add(a.n)}for(c=0;c<a.childNodes.length;c++)B(b,a.childNodes[c])}
function C(b,a){for(var c=0;c<a.a.length;c++)for(var d=0;d<a.a.length;d++)if(b.q++,c!=d&&Math.sqrt((a.a[c].d-a.a[d].d)*(a.a[c].d-a.a[d].d)+(a.a[c].b-a.a[d].b)*(a.a[c].b-a.a[d].b)+(a.a[c].e-a.a[d].e)*(a.a[c].e-a.a[d].e))<a.a[c].c+a.a[d].c){b.r++;var e=a.a[c],f=a.a[d],g=e.d-f.d,h=e.b-f.b,l=e.e-f.e,n=Math.sqrt(g*g+h*h+l*l)*(Math.sqrt(e.velocityX*e.velocityX+e.velocityY*e.velocityY+e.j*e.j)+Math.sqrt(f.velocityX*f.velocityX+f.velocityY*f.velocityY+f.j*f.j))/2,g=g/n,h=h/n,l=l/n;e.velocityX=g;e.velocityY=
h;e.j=l;f.velocityX=-1*g;f.velocityY=-1*h;f.j=-1*l}for(c=0;c<a.childNodes.length;c++)C(b,a.childNodes[c])}
function D(b,a){for(var c=[],d=0;d<a.a.length;d++){var e=a.a[d];if(e.d+e.c<a.left||e.d-e.c>a.right||e.b+e.c<a.top||e.b-e.c>a.bottom||e.e+e.c<a.g||e.e-e.c>a.i){var f=a.a,g=s(f,e);0<=g&&r.splice.call(f,g,1);c.push(e)}}for(d=0;d<a.childNodes.length;d++)D(b,a.childNodes[d]);if(a!==b.k)for(d=0;d<c.length;d++)y(b.k,c[d]);if(!w(a)){for(d=0;d<a.childNodes.length;d++)b.h.remove(a.childNodes[d].n);a.childNodes.length=0}}
A.prototype.step=function(){D(this,this.k);C(this,this.k);for(var b=0;1E3>b;b++){var a=this.f[b];a.velocityY-=0.1;a=this.f[b];-100>a.b-a.c&&(a.velocityY*=-0.8);this.f[b].step(1);this.o[b].position.x=this.f[b].d;this.o[b].position.y=this.f[b].b;this.o[b].position.z=this.f[b].e}B(this,this.k);this.m.t(this.h,this.l)};var E;E=new A;for(var F=0;F<arguments[0];F++)E.step();print(E.r);print(E.q);
